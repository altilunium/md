<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8">
	<link rel="icon" href="r/logo.png" type="image/x-icon">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rtnF md</title>

	<link rel="stylesheet" href="r/style.css">


</head>

<body>

	<!-- <div><textarea id="main-txtbox" name="body" rows="20" cols="80">{{printf "%s" .Body}}</textarea></div> -->
	<div id="main-txtbox" style="padding-bottom:250px;" contenteditable></div>
	<div id="tog" onclick="mdToggle()"></div>
	<div id="tog2" onclick="publish_p2p()"></div>
	<div id="tog3" onclick="backToBase()"></div>



</body>

<script src="r/marked.js"></script>
<link rel="stylesheet" href="r/h.css">
<script src="r/h.js"></script>
<script src="r/dexie.js"></script>
<script src="r/peerjs.js"></script>
<script src="r/engine.js"></script>
<script>
var peer = new Peer();
console.log(peer)
var conn = ""



async function publish_p2p() {
	var pro = prompt("Input p2p key")
	var p2p_key = "cpad_receiver_" + pro

	conn = peer.connect(p2p_key);
	console.log(conn)
	conn.on('open', function(){
		var payload = document.getElementById("main-txtbox")
  		conn.send(payload.innerHTML);
  		alert("Successful!")
 });

conn.on('error', function(err){
	console.log(err)
	alert(err)
})

}




</script>
